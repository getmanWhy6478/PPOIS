@startuml "Диаграмма состояний — принтер"
!theme plain
skinparam defaultFontSize 11

title Диаграмма состояний (UML 2.x)\nКонечный автомат принтера

state "OFF\n(выключен)" as OFF
state "IDLE\n(ожидание)" as IDLE
state "PRINTING\n(печать)" as PRINTING
state "PAUSED\n(пауза)" as PAUSED
state "OUT_OF_PAPER\n(нет бумаги)" as OUT_OF_PAPER
state "LOW_INK\n(мало чернил)" as LOW_INK
state "ERROR\n(ошибка)" as ERROR
state "MAINTENANCE\n(обслуживание)" as MAINTENANCE

[*] --> OFF : включение питания

OFF --> IDLE : power_on()\n[драйвер инициализирован,\nесть бумага и чернила]
OFF --> OUT_OF_PAPER : power_on()\n[лоток бумаги пуст]
OFF --> LOW_INK : power_on()\n[уровень чернил < 10%]
OFF --> ERROR : power_on()\n[ошибка инициализации]

IDLE --> OFF : power_off()
OUT_OF_PAPER --> OFF : power_off()
LOW_INK --> OFF : power_off()
ERROR --> OFF : power_off()
MAINTENANCE --> OFF : power_off()

IDLE --> PRINTING : print_document()\n[расходники проверены]

PRINTING --> IDLE : печать завершена успешно,\nдрайвер вернул true
PRINTING --> OUT_OF_PAPER : закончилась бумага\n(OutOfPaperError)
PRINTING --> LOW_INK : закончились чернила\n(LowInkError)
PRINTING --> ERROR : сбой драйвера\nили исключение

OUT_OF_PAPER --> IDLE : load_paper()\n[бумага загружена,\nвсе картриджи >= 10%]

LOW_INK --> IDLE : replace_ink()\n[все картриджи >= 10%]

IDLE --> MAINTENANCE : start_maintenance(operation)
ERROR --> MAINTENANCE : start_maintenance(operation)

MAINTENANCE --> IDLE : обслуживание успешно\n(previous_state или IDLE)
MAINTENANCE --> ERROR : обслуживание неуспешно\nили исключение

note right of IDLE
  Печать возможна только
  в состоянии IDLE
end note

note right of PRINTING
  Постраничное потребление
  бумаги и чернил;
  при исчерпании — переход
  в OUT_OF_PAPER / LOW_INK
end note

@enduml
